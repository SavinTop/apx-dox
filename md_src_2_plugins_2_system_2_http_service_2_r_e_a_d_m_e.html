<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>apx-gcs: &mdash;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">apx-gcs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">&mdash;</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md28"></a>
HTTP Server</h1>
<p>The GCS app has built-in HTTP server (listening on port <b>9280</b>).</p>
<p>Server capabilities include:</p>
<ul>
<li>Provide datalink stream to other GCS components;</li>
<li>Control any particular <a class="el" href="class_mandala.html">Mandala</a> variable;</li>
<li>Execute JavaScript commands;</li>
<li>Reply requested <a class="el" href="class_mandala.html">Mandala</a> variable value;</li>
<li><a href="http://earth.google.com">Google Earth</a> real-time flight visualization and analysis of telemetry data;</li>
</ul>
<p>To see the server welcome message - start the GCS and open this link in browser: <a href="http://127.0.0.1:9280"><code>http://127.0.0.1:9280</code></a></p>
<h2><a class="anchor" id="autotoc_md29"></a>
Multiple GCS operation</h2>
<p>The GCS can connect remotely to another GCS datalink through TCP connection. Each GCS instance creates server and accepts external connections.</p>
<p>When GCS finds another server in local network, it appears under menu <code>Preferences/Datalink/Remote servers</code> and can be used for datalink connection. Moreover, the direct connection could be set-up with the <code>Preferences/Datalink/Local Ports</code>.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
VPN Support</h2>
<p><a class="el" href="class_datalink.html">Datalink</a> server has the capability to establish connection through internet with another GCS.</p>
<p>Two or more GCS interfaces could be connected to one or more datalink modems. the connection requires <b>static ip</b>, thus VPN connection is recommended.</p>
<p>To request for online support for tuning or troubleshooting, <a href="/contacts">contact us</a> to receive credentials to access our network.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Mandala control</h2>
<p>The HTTP server will accept any request beginning with <code>/mandala</code>. The request parameters are following <code>?</code> char, and are optional. Several request parameters can be combined in one request and separated by the <code>&amp;</code> sign.</p>
<p>The following parameters are accepted:</p>
<ul>
<li><code>&lt;variable name&gt;</code> - will return it's value, f.ex. <code>?ctr.str.brake</code>;</li>
<li><code>&lt;variable name&gt;=&lt;value&gt;</code> - will set the new value and send it to UAV;</li>
<li><code>descr</code> - variables will be returned with their descriptions;</li>
<li><code>scr=&lt;JS script&gt;</code> - will evaluate JS script in the application context;</li>
</ul>
<p>For example, assuming you run GCS on the local machine, the following requests are valid:</p>
<ul>
<li><a href="http://127.0.0.1:9280/mandala">http://127.0.0.1:9280/mandala</a> - will return xml list of all variables and their current values;</li>
<li><a href="http://127.0.0.1:9280/mandala?descr">http://127.0.0.1:9280/mandala?descr</a> - same as above, but will include descriptions;</li>
<li><a href="http://127.0.0.1:9280/mandala?descr&amp;md.pos.altitude&amp;est.att.roll">http://127.0.0.1:9280/mandala?descr&amp;cmd.pos.altitude&amp;est.att.roll</a> - will return only two values specified, with descriptions;</li>
<li><a href="http://127.0.0.1:9280/mandala?cmd.pos.altitude=1000&amp;est.att.roll">http://127.0.0.1:9280/mandala?cmd.pos.altitude=1000&amp;est.att.roll</a> - will set commanded altitude to 1km and return current values;</li>
<li><a href="http://127.0.0.1:9280/mandala?cmd.proc.mode=proc_mode_TAKEOFF">http://127.0.0.1:9280/mandala?cmd.proc.mode=proc_mode_TAKEOFF</a> - this will change current mode to TAKEOFF procedure;</li>
<li><a href="http://127.0.0.1:9280/mandala?scr=cmd.proc.mode=proc_mode_EMG">http://127.0.0.1:9280/mandala?scr=cmd.proc.mode=proc_mode_EMG</a> - will execute a JS script to change current mode to manual control;</li>
<li><a href="http://127.0.0.1:9280/mandala?scr=ctr.str.brake=trigger(ctr.str.brake,0,1)">http://127.0.0.1:9280/mandala?scr=ctr.str.brake=trigger(ctr.str.brake,0,1)</a> - toggle parking brakes by script;</li>
<li><a href="http://127.0.0.1:9280/mandala?scr=btn_BRAKE()">http://127.0.0.1:9280/mandala?scr=btn_BRAKE()</a> - toggle parking brakes by calling function defined in <a href="https://github.com/uavos/apx-gcs/blob/main/resources/scripts/gcs.js"><code>gcs.js</code></a>;</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
Google Earth Visualization</h2>
<p>Add the following link to Google Earth:</p>
<p><code><a href="http://">http://</a>&lt;IP address of GCS machine&gt;:9280/kml</code></p>
<p>.. i.e. if you run both the GCS and GoogleEarth on the same machine, use:</p>
<p><code><a href="http://127.0.0.1:9280/kml">http://127.0.0.1:9280/kml</a></code></p>
<p><img src="assets/googleearth.png" alt="GoogleEarth Visualization" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
